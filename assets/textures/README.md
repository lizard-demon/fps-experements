# Texture Module

This directory contains a complete texture management system bundled into a single module.

## Directory Structure

- `mod.zig` - Main texture module (library + conversion utilities)
- `convert.sh` - Standalone conversion script
- `png/` - Source PNG files (create your textures here)
- `*.rgba` - Converted RGBA files (generated by conversion)

## Quick Start

### Use the Zig module
```zig
const texture = @import("texture");

// Initialize registry - automatically loads from assets/textures/
var registry = try texture.Registry.init(allocator);
defer registry.deinit();

// Get texture UV coordinates
const uv = registry.getAtlasUV("my_texture");
```

### Convert textures with shell script
1. **Create PNG textures** in the `png/` directory
2. **Convert them**: `./assets/textures/convert.sh`
3. **Load in code**: Use TextureRegistry.loadFromDirectory()

## Workflow

2. Run `./assets/textures/convert.sh` to convert PNG to RGBA
3. Initialize with `texture.Registry.init(allocator)` - automatically loads assets/textures/
4. Get UV coordinates: `registry.getAtlasUV("texture_name")`

## Module Features

- **Simple API**: Single `Registry` struct with `init()` and `getAtlasUV()`
- **Name-based access**: Get textures by filename (without extension)
- **Automatic loading**: Loads entire directories of RGBA files
- **Atlas packing**: Efficient texture atlas generation
- **Direct access**: Public fields for advanced usage

## Example Usage

```zig
const texture = @import("texture");

// Create registry - automatically loads from assets/textures/
var registry = try texture.Registry.init(allocator);
defer registry.deinit();

// Direct access to data
std.log.info("Atlas size: {}x{}", .{registry.atlas_size, registry.atlas_size});
std.log.info("Loaded {} textures", .{registry.texture_map.count()});

// Get UV coordinates for rendering
const uv = registry.getAtlasUV("test");
```

## API Reference

```zig
pub const Entry = struct {
    uv_offset: Vec2,       // UV offset in atlas (0.0-1.0)
    uv_size: Vec2,         // UV size in atlas (0.0-1.0)
    original_size: Vec2,   // Original texture dimensions
};

pub const Info = struct {
    name: []const u8,      // Texture name (without extension)
    pixels: []u32,         // RGBA pixel data
    width: u32,            // Texture width
    height: u32,           // Texture height
    atlas_x: u32,          // Position in atlas
    atlas_y: u32,          // Position in atlas
};

pub const Registry = struct {
    atlas_texture: sg.Image,              // GPU texture atlas
    atlas_view: sg.View,                  // Texture view for rendering
    atlas_size: u32,                      // Atlas dimensions
    texture_map: StringHashMap(Entry),    // Name -> UV mapping
    
    pub fn init(allocator) !Registry      // Loads from assets/textures/
    pub fn getAtlasUV(texture_name) [2]f32
};
```

## Supported Sizes

The texture loader supports square textures with these dimensions:
- 16x16, 32x32, 64x64, 128x128, 256x256, 512x512, 1024x1024

## Current Status

- âœ… `test.rgba` - Currently loaded and used by all geometry
- ðŸ”„ Add more textures by placing PNG files in `png/` and running the conversion script

## Notes

- Textures are automatically packed into an atlas for optimal performance
- Reference textures by filename (without extension) in the code
- The game requires at least one texture file to run